# Change Log

All notable changes to the "vscode-qlite" extension will be documented in this file.

## [1.5.5] - 2023-08-03

### Changed
- 修改登录协议设置的值，之前修改过此设置的用户需要将此设置移除才可正常使用

### Fixed
- 修复取消输入ticket和进行设备锁验证时没有刷新登录状态的bug
- 修复无法热重启的bug
- 修复热重启可选择已登录账号的bug

## [1.5.4] - 2023-08-02

### Changed
- 找到了一个较为成熟的`extension <--> webview`通信协议，替换自己编写的`message-handler`协议，解决通信产生的小问题

### Fixed
- 修复登录界面无法二次登录的bug

## [1.5.3] - 2023-07-31

### Changed
- 修改消息头（显示头衔、名称、时间的部分）的样式，支持跟随vscode主题的切换

### Fixed
- 修复群聊接收两次本人发言的bug
- 修复预览图片图层被新消息覆盖的bug
- 修复预览图片过高时显示不全的bug

## [1.5.2] - 2023-07-21

### Changed
- 更新icqq，添加`sign api`
- 登录失败能快捷打开开发者工具查看日志输出（没啥大用）

### Fixed
- 修复扩展市场中扩展说明乱码的bug

## [1.5.1] - 2023-06-21

### Added
- 登录页面添加`登录状态`选项
- 支持修改`个人资料`的某些项
- 聊天页面支持显示`通知`、`戳一戳`消息

### Changed
- 调整`msgHandler`类的接口调用方式，降低开发难度
- 搜索好友与群聊合并，可同时搜索
- 更换一个更稳定的获取`qq表情`图片的网址

### Removed
- 登录页面移除`登录方式`选项

### Fixed
- 修复自动登录失败后无法再次登录的bug
- 修复每次登录都会重新创建`device`信息的bug（fixed from icqq）

## [1.5.0] - 2023-06-12

### Removed
- 移除旧版聊天主题的资源文件，全部改用网络资源，不占用本地空间

### Changed
- 聊天页面应用新版主题，旧版页面功能基本移植完毕
- 新版聊天页面的脚本全部采用`typescript`编写，与项目的其他源文件同步编译并应用，简化开发难度

## [1.4.5] - 2023-06-07

### Added
- `登录设备`现在是可设置项，用户能在vscode的设置中进行修改

### Removed
- 移除了通过`puppeteer`进行自动化抓包的功能，用户目前只能通过手动抓包的方式获取ticket，等待后续寻找更好的解决方案

## [1.4.4] - 2023-05-15

### Added
- 为电脑中没有`chromium`工具的用户提供备选方案（手动输入信息）

## [1.4.3] - 2023-05-12

### Changed
- 由于icqq更新后不支持扫码登录，所以暂时禁用扫码登录手段
- 修改icqq的日志等级，如果出现错误可以通过日志发现问题

### Fixed
- 修复设置中切换账号失败的bug
- 修复登录页面中登录失败无法重新输入的bug

## [1.4.2] - 2023-04-28

### Changed

- 修改扩展与网页的通信协议，增强其通用性，为聊天页面的通信方式打基础
- 优化设置选单的显示内容
- 优化登录页面，将登录方式选框移至顶部，页面依据不同选项动态切换显示内容

## [1.4.1] - 2023-04-23

### Changed

- 放弃`esbuild` ~~（玩不懂）~~ ，使用`webpack`作为打包工具

## [1.4.0] - 2023-04-21

### Added

- 登录功能大改，扩展初始化展示一个`webview`类型的登录页面，交互更友好
- 引入`vscode`风格的网页组件，降低页面在`vscode`中的违和感
- 添加登陆时`ticket`的自动抓取功能（研究了好久），移除过多的右下消息弹窗
- 添加`prettier`配置，统一代码风格

### Changed

- 切换打包格式，使用`esbuild`打包项目（为了正确编译`webview`页面的脚本文件）
- 登录模块、消息列表模块、账号管理模块的代码之间进行解耦，尽量都能独立使用
- 扩展存储目录移动到用户根目录下的`.qlite`文件夹中，便于查找和修改

## [1.3.9] - 2023-04-10

### Fixed

- 将核心库oicq更换为icqq，解决QQ版本过低的问题

## [1.3.8] - 2023-03-22

### Fixed

- 修复私聊发送出去的消息/文件无法显示的bug

## [1.3.7] - 2023-03-01

### Added

- 在聊天窗口底部与最后一条消息添加一段间隔，美化显示效果

### Fixed

- 再次更改消息同步逻辑，私聊中发送出去的消息/文件将会在发送完毕（上传到服务器）时获取到消息的其他信息并将消息/文件显示在聊天窗口中

## [1.3.6] - 2023-01-28

### Added

- 支持移除消息栏中的新消息
- 添加侧边栏好友/群头像显示

### Fixed

- 修复快捷切换账号后消息栏的消息不刷新的bug

### Changed

- 合并查看好友/群资料的命令

### Removed

- 移除登录提示

## [1.3.5] - 2023-01-23

### Added

- 无登录账号时显示欢迎界面，现通过欢迎界面登录账号
- 支持多账号的快捷切换，登录后右上角的设置按钮中的账号切换功能可列出在此扩展中登陆成功过的所有账号
- 添加空资料界面，后续添加对应好友/群信息显示

### Changed

- 修改侧边栏的设置按钮功能，取消其中的登录功能，在登录后支持账号切换和状态切换，退出功能在账号切换的子选项中

## [1.3.4] - 2023-01-18

### Added

- 好友聊天现在支持文件发送功能，群聊的文件管理较复杂，后续跟进
- 添加手动刷新聊天消息的功能，发送文件可能不会立刻显示发送的文件消息，目前只能手动刷新或重新打开聊天界面才能解决
- 侧边栏支持右键好友/群查看好友/群资料，对应功能暂未实装

### Fixed

- 修复文件消息的获取和下载功能
- 修复消息查重可能失误的bug

## [1.3.3] - 2023-01-14

### Fixed

- 修复无法有效点击工具栏内容的bug
- 修复输入框编辑多行文本时发送无法识别换行符的bug

## [1.3.2] - 2023-01-14

### Fixed

- 修复发送图片无法在消息中正常显示的bug
- 修复连续点击不同的工具栏按钮时前一个工具栏不会消失的bug

### Changed

- 更换消息页面工具栏的按钮样式，并美化了样式
- 优化了小程序分享的json消息的显示效果

## [1.3.1] - 2023-01-14

### Fixed

- 修复上一版本中私聊消息无法加载的bug

## [1.3.0] - 2023-01-13

### Added

- 现在支持双击消息栏昵称和点击输入框上方的`@`按钮AT其他人，AT词条会加入到输入框中，可以组合其他内容发送
- 从 [sysnapse](https://github.com/sysnapse/vscode-qq-console-theme) 大佬魔改自前扩展的console主题页面搬运了解析更多qq消息类型的功能：对json消息的解析，视频消息的预览，文件消息对文件名和大小的显示。但以上功能并未作相关测试，希望使用相关功能的用户能反馈一下显示效果

### Changed

- 优化了整个页面的代码结构（终于完完整整地读完旧代码了）和注释，尽力作了模块化，大佬可视情况魔改
- 发送键同步win端的QQ默认按键，`Enter`发送消息，`Shift+Enter`换行，后续可能会实现用户自定义

### Removed

- 移除了群聊中消息头像旁的菜单按钮，计划将相关功能分散到其他部分

## [1.2.8] - 2023-01-12

### Changed

- 漫游表情栏的图片排列顺序改为由新到旧的顺序

### Fixed

- 修复发送大图时本地无法正常显示的bug

## [1.2.7] - 2023-01-11

### Added

- 添加双击消息框中图片能放大查看的功能，单击放大后的图片即可退出

### Changed

- 修改聊天框中表情大小，与文字高度一致

### Fixed

- 修复发送表情失败的问题

## [1.2.6] - 2023-01-10

### Changed

- 优化表情栏的显示效果

### Fixed

- 修复群聊中的at功能，现在能通过

  - 点击其他人消息中的at链接
  - 点击头像旁的`...`，在选项框中选择`@AT`
  - 双击消息中的昵称
  
  来at其他人

### Removed

- 由于oicq已弃用回复消息的功能，因此本扩展也删除了该功能

## [1.2.5] - 2023-01-09

### Fixed

- 修复通知提示功能
- 修复群聊发送消息重复显示的问题

## [1.2.4] - 2023-01-09

### Fixed

- 修复输入框粘贴html格式文本时带格式粘贴导致无法发送消息的问题

## [1.2.3] - 2023-01-09

### Added

- 添加输入框按钮的交互效果
- 现在通过拖动分割线可以改变两个容器的显示比例

### Changed

- 美化表情工具栏的显示效果

### Removed

- 移除emoji工具栏
- 移除粘贴图片工具栏（通过`ctrl+v`直接粘贴）

## [1.2.2] - 2023-01-09

### Added

- 当浏览历史聊天记录（窗口离底部有一段距离）时收到新消息不再滑动窗口到底部
- 上划获取历史记录时将停留在当前记录位置

### Changed

- 将消息的序列号信息合并到消息块中，减少页面冗余

### Fixed

- 修复私聊时聊天界面显示昵称的问题

## [1.2.1] - 2023-01-08

### Added

- 输入框支持发送qq表情和漫游表情

## [1.2.0] - 2023-01-08

### Added

- 输入框支持发送粘贴的图片

### Changed

- 输入框升级为富文本框，可显示粘贴的图片和文字

## [1.1.4] - 2023-01-08

### Changed

- 重绘聊天输入框，恢复了读取漫游表情的功能，但没完全恢复（因为还不能发送）

## [1.1.3] - 2023-01-07

### Changed

- 修改css文件，优化消息显示效果

### Fixed

- 修复消息中表情与文本不对齐的问题

## [1.1.2] - 2023-01-06

### Changed

- 聊天图片从链接改为直接显示

## [1.1.1] - 2023-01-06

### Added

- 为登陆选项添加小图标，优化了显示效果

### Changed

- 修改搜索功能的显示效果

## [1.1.0] - 2023-01-05

### Added

- 添加好友和群聊的搜索功能

### Fixed

- 修复新群友加群时也会出现提示的问题

## [1.0.3] - 2023-01-05

### Added

- 添加登出账号的二次确认窗口

### Changed

- 账号为离线状态时侧边栏设置为空

## [1.0.2] - 2023-01-04

### Added

- 切换账号需要二次确认

### Changed

- 修改聊天窗口图标为自定义

### Fixed

- 修复当前聊天窗口收到消息时侧边栏显示新消息的问题

## [1.0.1] - 2023-01-04

### Fixed

- 修复消息内容和头衔显示错误的问题

## [1.0.0] - 2023-01-04

### Added

- 实现侧边栏新消息加入消息列表功能

## [0.3.1] - 2023-01-04

### Added

- 添加了对好友增减时的消息通知
- 添加了对群头衔变化时的消息通知

## [0.3.0] - 2023-01-04

### Added

- 实现了群增减时的消息通知和侧边栏信息同步更新功能

## [0.2.4] - 2023-01-03

### Changed

- 修改群聊中的头衔名显示

### Deprecated

- 计划删除头像放大预览功能

## [0.2.3] - 2023-01-03

### Added

- 添加消息同步功能（原扩展已实现）

### Changed

- 修改页面缓存的数据类型，使其能够按key索引
- 将向页面发送事件的子函数（`PostPrivateEvent`、`PostGroupEvent`）整合到绑定消息事件函数（`bind`）中

## [0.2.2] - 2023-01-02

### Fixed

- 统一设置私聊对话不显示昵称，群聊显示群友昵称

## [0.2.1] - 2023-01-02

### Fixed

- 修复私聊窗口中对话误添加`title`的问题

## [0.2.0] - 2023-01-02

### Changed

- 重新匹配`types`中`webview`中所有函数的接口，将统一从客户端类调用函数拆分为分别从私聊类和群聊类调用各自的函数
- 重写聊天界面对网页端发送的信息的处理函数，由于函数调用对象更改，获取历史记录的参数将不再需要`msg_id`，因此删除对此函数的特别处理
- 聊天窗口的预处理js文件中重写了api列表，重新分配对应的函数功能，其中在群聊中将不实例化私聊特有的函数，反之亦然，以免产生参数冲突
- 聊天窗口的js文件中对于加载群成员列表的函数改为`promise`调用形式
- 由于获取历史记录等功能不再需要`msg_id`，因此将其全部替换为`seq`，即消息序号
- 将原函数api更新为新api列表中的函数

### Removed

- 移除聊天窗口的js文件中不必要的变量声明（移除的变量都能直接从`webview`类中调用）
- 原代码中发送消息会返回发送状态，但oicq2.0中返回信息删减，无法作相应处理，因此暂时对该部分代码作注释处理

## [0.1.1] - 2022-12-31

### Changed

- 更新聊天界面中获取用户昵称的方法

### Fixed

- 修复原扩展中群资料读取失败的问题

## [0.1.0] - 2022-12-31

### Added

- 添加配置文件读写功能，实现自动登录上次的账号
- 添加账号扫码登陆
- 添加登录状态改变选项
- 添加切换账号选项
- 添加登出选项

## Changed

- 修改默认的`README`文件，公开代码仓库

## Removed

- 移除`vsc-extension-quickstart.md`文件

## Fixed

- 修复原扩展中无法加载历史聊天记录的问题

## [0.0.2] - 2022-12-29

### Added

- 添加原`webview`相关文件，初步修复新版本oicq的历史消息读取功能

## [0.0.1] - 2022-12-25

### Added

- 完成基础的QQ登录行为
- 实现QQ联系人列表的读取、分组和动态树视图展示
